<!doctype html>
<html lang="en">

<!-- Mirrored from snook.ca/archives/cakephp/elemental_conditional_content_with_cakephp by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 25 Apr 2021 22:04:57 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
	<title>Elemental: Conditional Content with CakePHP - Snook.ca</title>
	<meta name="viewport" content="width=device-width" />
		<link rev="canonical" type="text/html" href="https://snook.ca/archives/cakephp/elemental_conditional_content_with_cakephp">
	<meta property="og:url" content="https://snook.ca/archives/cakephp/elemental_conditional_content_with_cakephp">
	<meta property="og:title" content="Elemental: Conditional Content with CakePHP">
	<meta property="og:description" name="description" content="I finally got around to implementing conditional content here on  Snook.ca. I've wanted to do this since I moved to the new design just  over a month and a half ago. The left sidebar has a number of e...">
	<meta property="og:type" content="article">
				<meta property="og:image" content="https://snk.ms/logo.gif">
		<meta name="twitter:card" content="summary">
				<meta name="theme-color" content="#680">
	<link rel="alternate" type="application/rss+xml" title="XML" href="https://snook.ca/jonathan/index.rdf"> 
<!--	<link rel="stylesheet" href="/css/snook-v10.css"> -->
<style>
/* A font by Jos Buivenga (exljbris) -> http://www.exljbris.nl */

@font-face { font-family: 'MuseoCustom'; src: url('https://snook.ca/css/MuseoSans_500-webfont.woff2') format('woff2'), url('https://snook.ca/css/MuseoSans_500-webfont.woff') format('woff'); font-weight: normal; font-style: normal; }
@font-face { font-family: 'Playfair Display'; font-style: normal; font-weight: 900; src: local('Playfair Display Black'), local('PlayfairDisplay-Black'), url('https://snook.ca/css/playfair.woff2') format('woff2'), url(https://fonts.gstatic.com/s/playfairdisplay/v10/UC3ZEjagJi85gF9qFaBgIFG5nCscAKpKP81nraB-v6E.woff) format('woff'); unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215; }
html{background:#EEEEE6 url(https://snook.ca/img/bg.png)}body{margin:0;padding:0;border:12px solid #680;font-family:'PT Serif',Georgia,Times,'Times New Roman',serif;background:url(https://snook.ca/img/swash.svg) no-repeat 50% 0;background-size:1600px 200px;color:#333;line-height:1.7;min-height:calc(100vh - 24px)}img{border:0}figcaption{font-style:italic;font-size:90%;}p{margin-bottom:1.5em}hr{width:20%;}a{color:#680;transition:all .2s}a:hover{text-decoration:none}a:active,a:focus{background-color:rgba(51,51,51,.1)}blockquote{font-style:italic;font-size:95%;background:url(https://snook.ca/img/comment.svg) no-repeat 2px 5px;margin:0;padding-left:20px}pre{margin-left:-20px;background:url(https://snook.ca/img/code-bookmark.svg) no-repeat 0 0}pre code{display:block;margin-left:20px;padding:10px;font-size:90%;background-color:rgba(255,255,255,.5);overflow:auto}table{border:1px solid #666;border-width:1px 0;border-collapse:collapse;background-color:rgba(255,255,255,.5);margin-bottom:30px;font-size:90%}th{border:1px solid #666;border-width:1px 0;background-color:rgba(51,51,51,.1)}td{border:1px solid #CCC;border-width:1px 0;padding:2px 10px}.update{background-color:rgba(33,129,66,0.1);padding:5px 10px 1px;border-radius:5px}#header{font-family:'MuseoCustom','Century Gothic',Arial,Helvetica,sans-serif;font-size:13px;max-width:780px;margin:auto;line-height:12px;background:url(https://snook.ca/img/snook-bookmark.svg) no-repeat;padding:0 20px}#header h1,#header h2{font-size:13px;font-weight:400;margin:0}#header h1{color:#680;padding-top:18px;text-transform:uppercase}#header h2 a{text-decoration:none;color:#333;display:block}#header h2 a:hover{color:#680}#header .nav{text-transform:uppercase;word-spacing:4px;padding-top:20px}#header .nav a{text-decoration:none;color:#333;padding-top:3px}#header .nav a:hover{color:#680}.blurb{line-height:1.3}#content{max-width:820px;margin:4em auto;background:url(https://snook.ca/img/star.svg) no-repeat 3px 58px}#main{padding:40px 0 0;background:url(https://snook.ca/img/line-v.png) no-repeat 100% 90%}#main .dt,#main .cat,#main .shorturl{font-family:Garamond,Georgia,Times,'Times New Roman',serif;text-transform:uppercase;font-size:13px;font-weight:700;color:#666;background:url(https://snook.ca/img/line.png) no-repeat -200px 70%}#main h2{font-weight:900;font-size:28px;margin:7px 0 0;font-family:'Playfair Display',Garamond,serif;line-height:1.1;background:url(https://snook.ca/img/line.png) no-repeat 100px 26px}#main h2 a{text-decoration:none;color:#444}#main h2 a:hover{color:#680}.article-image-small{margin-top:20px;text-align:center;background-color:#000;padding:6px;font-size:0;display:inline-block;}.article-image{text-align:center;background-color:rgba(0,0,0,.07);padding:14px 12px;font-size:0px;width:calc(100vw - 24px);position:relative;left:50%;right:50%;margin:20px -50vw 4rem -50vw;}#main .article.inside h1{font-weight:900;font-size:2em;margin:0 0 2em;font-family:'Playfair Display',Garamond,serif;line-height:40px;background:url(https://snook.ca/img/line.png) no-repeat 100px 90%}#main .article.inside h2{font-family:'Playfair Display',Georgia,Times,'Times New Roman',serif;font-weight:900;font-size:1.5em;text-transform:none;background:none}@media only screen and (min-width: 480px){#main .article.inside{font-size:120%}}#main .article{margin-bottom:40px;padding:0 20px;background:url(https://snook.ca/img/star.svg) no-repeat 2px 13px}#main .article:first-child{background:none}#main .article img{max-width:100%;max-height:80vh;}#main .article .abstract{font-size:110%;}#main .fullarticle{text-align:right;background:url(https://snook.ca/img/line.png) no-repeat 190% 70%}#main .fullarticle a{text-transform:uppercase;text-decoration:none;color:#680;font-size:14px;padding:4px}#main .fullarticle a:hover{background-color:rgba(51,51,51,.1)}#main .meta{background:url(https://snook.ca/img/star.svg) no-repeat 3px .3em;font-family:Garamond,Georgia,Times,'T\Aimes New Roman',serif;padding-left:20px;margin-top:40px}#main .shorturl .url{text-transform:none;color:#555}#comments .meta{background:url(https://snook.ca/img/comment-bookmark.svg) no-repeat 0 3px}#comments .comment{background:url(https://snook.ca/img/comment.svg) no-repeat 3px .6em}#comments .comment .meta .authorname{text-transform:uppercase}#comments .comment .meta .commentnumber a{float:right;color:rgba(51,51,51,.25);font-size:24px;text-decoration:none}#comments .comment .quote{padding-left:20px;font-size:95%;word-break:break-word}#comments .commentcount{text-transform:uppercase}#comments .comment .meta{background:url(https://snook.ca/img/line.png) no-repeat 40px 1.1em}#comments .snook{background:url(https://snook.ca/img/comment-snook.png) no-repeat 0 3px}#comments .snook .meta .commentnumber a{color:rgba(102,136,0,.5)}#comments .snook .meta .commentnumber a:hover{color:rgba(102,136,0,1)}h3#postcomments{text-transform:uppercase;font-weight:400;font-size:14px;background:url(https://snook.ca/img/line.png) no-repeat 40px 14px;margin:0 20px}#comments_form{background:url(https://snook.ca/img/line-v.png) no-repeat 10px 0;padding-left:20px}#comments_form .inputgroup{background:url(https://snook.ca/img/line.png) no-repeat 100% 100%;margin-bottom:5px}#postmeta{margin-bottom:10px}#postdata{background:url(https://snook.ca/img/line-v.png) no-repeat 100% 50%}#postdata textarea{width:100%;border:none;font-size:inherit;font-family:inherit;padding:10px;box-sizing:border-box}#postmeta label{width:80px;display:block;float:left;text-transform:uppercase;font-size:10px}#postmeta input{border:none;max-width:407px}#comments_form .formnote{font-size:80%}#commentsclosed{padding:10px;margin:20px 0;background:rgba(51,51,51,.1)}#livepreview{display:none}#main .article ul.projects{list-style:none;margin:0;padding:0;overflow:hidden}ul.projects li{margin:0 10px 20px 0;padding:0;float:left;width:240px;line-height:15px;list-style:none}ul.projects li img{float:left;margin-right:5px;border:5px solid #CCC}ul.projects li a:hover img{border-color:#BBCF7F}ul.projects li span{display:block;font-size:12px}#footer{clear:both;font-size:90%;margin-bottom:-12px;}#footer .shell{max-width:770px;margin:auto;}#footer #copyright p{font-family:MuseoCustom,Helvetica,sans-serif}#footer #copyright .shell{padding:0 25px 200px;background:url(https://snook.ca/img/PolySnook.svgo.svg) no-repeat 50% 120%;background-size:400px 250px}iframe{max-width:100%;}
</style>
	<link rel="stylesheet" href="https://snook.ca/css/snook-v10-print.css" media="print">	
</head>
<body>
	<div id="header">
		<h1>Snook.ca</h1>
		<h2><a href="https://snook.ca/">LIFE &amp; TIMES of a WEB DEVELOPER</a></h2>
		<div class="nav"><a href="https://snook.ca/about/">About</a> &middot;  <a href="https://snook.ca/contact/">Contact</a> &middot; <a href="https://snook.ca/archives/">Archives</a></div>

	</div>
	<div id="content">
	<div id="main">
		<div class="article inside">
	
	<h1>Elemental: Conditional Content with CakePHP</h1>
		<p>I finally got around to implementing conditional content here on  Snook.ca. I've wanted to do this since I moved to the new design just  over a month and a half ago. The left sidebar has a number of elements  like the projects I've worked, quick links, etc. As some people have  noticed, if the article was particularly short, the comments would  often overlap the rather lengthy content. I didn't want that.</p>
<p>With a little bit of late night development and some quick help from  Larry (aka PhpNut, the lead developer of CakePHP), I've developed what  I have dubbed &quot;Elemental&quot;.</p>
<h2>Elemental</h2>
<p>Elemental consists of 2 parts: some new controller methods added to <code>app_controller.php</code>, and a new helper called Elemental.</p>
<p>In app_controller.php add:</p>
<pre><code>    function enableComponent($component, $params=null)<br />    {<br />       $name = Inflector::camelize($component);<br />       $found = loadComponent($name);<br />       if($found)<br />       {<br />          $cn = $name . 'Component';<br />          $comp = new $cn($params);<br />          $comp-&gt;startup($this);<br />          $this-&gt;viewVars['elements'][$component] = true;<br />       }<br />    }<br /><br />    function enableElement($element)<br />    {<br />       $this-&gt;viewVars['elements'][$element] = true;<br />    }<br /><br />    function disableElement($element)<br />    {<br />      $this-&gt;viewVars['elements'][$element] = false;<br />    }<br /></code></pre>
<p>The methods <code>enableElement </code>and disableElement will turn on or off whether a particular element should be displayed in the view. The method <code>enableComponent</code> takes the extra step and conditionally loads a component and enables the related element that goes along with that.</p>
<p>To use the element in your view just do:</p>
<pre><code>echo $elemental-&gt;load('projects');</code></pre>
<p>In this particular example, it calls the <code>projects.ctp</code> element. This should work exactly like <code>$this-&gt;renderElement</code> but will only load if the element has been enabled using <code>enableElement </code>or <code>enableComponent</code>..</p>
<p>Here's the Elemental helper:</p>
<pre><code>&lt;?php<br />class ElementalHelper extends Helper {<br />  function load($element, $params=array())<br />  {<br />    $view =&amp; ClassRegistry::getObject('view');<br />    if(isset($view-&gt;viewVars['elements']) &amp;&amp;<br />       isset($view-&gt;viewVars['elements'][$element]) &amp;&amp;<br />       $view-&gt;viewVars['elements'][$element])<br />    {<br />      return $view-&gt;renderElement($element, $params);<br />    }<br />  }<br />}<br />?&gt;</code></pre>
<h2>Using it on Snook.ca</h2>
<p>What I've done on Snook.ca then, is to break up the sidebar into a few different elements. All elements are enabled by default via the app_controller. Then, in my posts controller, I check the length of the body element and disable elements as the article gets shorter. Here are some examples:</p>
<ul>
    <li><a href="https://snook.ca/archives/javascript/private_javascript/">Long article</a>   shows all elements</li>
    <li><a href="https://snook.ca/archives/conferences/wjs2007/">Medium-sized article</a> shows just some of the elements</li>
    <li><a href="https://snook.ca/archives/quick_links/quick_link_ie6_memory_leaks_fixed/">Short article</a> shows no elements</li>
</ul>
<p>I can now keep the sidebars light and avoid overlap or throw in some bonus material if the article is longer.</p>	
</div>
<div class="meta">
	<div class="dt">Published June 23, 2007 &middot; Updated June 23, 2007</div>
	<div class="cat">Categorized as <a href="https://snook.ca/archives/cakephp/">CakePHP</a></div>
	<div class="shorturl">Short URL: <span class="url">https://snook.ca/s/827</span></div>
</div>

<div id="comments">
	<div class="meta">
		<h2>Conversation</h2>
		<div class="commentcount">13 Comments &middot; <a href="https://snook.ca/archives/cakephp/elemental_conditional_content_with_cakephp.rss">RSS feed</a></div>
		<div class="commentfeed"></div>
	</div>
	
		<div class="comment" id="c49847">
		<div class="meta">
			<div class="commentnumber"><a href="#c49847">1</a></div>
			<span class="authorname">Mandy</span> said on June 24, 2007		</div>
		<div class="quote"><p>Hey thanks for sharing this. However, I still am little confused wrt renderElement vs your enableElement. renderElement can also do choicing out of content based on our conditions...do you mean to say, it will still load those elements but then just not display them and your enableElement will not even load them? Like how is it diff from -</p>
<pre>
<code>
if ($x = 1) {
  echo $this-&gt;renderElement('projects1');
} else {
  echo $this-&gt;renderElement('projects2');
}
</code>
</pre>
</div>
	</div>
		<div class="comment" id="c49865">
		<div class="meta">
			<div class="commentnumber"><a href="#c49865">2</a></div>
			<span class="authorname">Tarique Sani</span> said on June 24, 2007		</div>
		<div class="quote"><p>This is so cool - I can think of combining it with some other stuff out there and we have got truely dynamic or contextual sidebars </p>
<p>Thanks for the efforts
</p>
</div>
	</div>
		<div class="comment snook" id="c49879">
		<div class="meta">
			<div class="commentnumber"><a href="#c49879">3</a></div>
			<span class="authorname">Jonathan Snook</span> said on June 24, 2007		</div>
		<div class="quote"><p>@Mandy: Sure, renderElement vs enableElement may seem trivial but I dislike having to put conditionals around everything in my view. Being able to easily turn it on or off via the controller is nice, leaving my views really clean. Think about using this for displaying admin menus or what have you. In addition, using enableComponent is the sweetest part as components get loaded only when needed and allows you to link a component with an element and have both "turned on" via one command. That's why I like it. :)
</p>
</div>
	</div>
		<div class="comment" id="c49884">
		<div class="meta">
			<div class="commentnumber"><a href="#c49884">4</a></div>
			<span class="authorname"><a href="http://www.nateklaiber.com/">Nate Klaiber</a></span> said on June 24, 2007		</div>
		<div class="quote"><p>Looks good Snook. I agree with you, I would rather have the logic for this inside of my controllers versus the view. I despise using conditional statements in my views (regardless of the framework). </p>
<p>I have found myself using custom helpers for some things. For things like alternating and such - I create a custom method in my helpers to display thing accordingly (some of this might be included in an element). This is usually for things that are nested in a loop and cannot be achieved in the controller (without running through result sets and assigning new arrays).</p>
<p>I like how you have it check the length of the content and only include as necessary - keeps your frontend layout nice and clean as well! Nice work...
</p>
</div>
	</div>
		<div class="comment" id="c49962">
		<div class="meta">
			<div class="commentnumber"><a href="#c49962">5</a></div>
			<span class="authorname">Nasko</span> said on June 25, 2007		</div>
		<div class="quote"><p>This is really neat, Jonathan. I have an ongoing project where I've managed to do without using conditionals in my views by setting variables to empty strings and still echoing them in my views. No doubts you've shared a neater approach and I'm going to revise my code :-)</p>
<p>Thanks!
</p>
</div>
	</div>
		<div class="comment" id="c50064">
		<div class="meta">
			<div class="commentnumber"><a href="#c50064">6</a></div>
			<span class="authorname">Andy Dawson (AD7six)</span> said on June 26, 2007		</div>
		<div class="quote"><p>Hi Jonathan,</p>
<p>I like the freedom/cleanliness of what you propose here, I'm curious as to what your components look like, and what convention, if any, you follow for the data that you want to pass from your components to your elements. There is the risk for element and main content vars to overlap/conflict if there is no active separation.</p>
<p>I wrote about <a href='http://www.noswad.me.uk/MiBlog/MiniControllers'>something similar in the past</a>, in which I always rendered a side_bar element which would loop on the defined/enabled dynamic elements - didn't seem perfect at the time since the side_bar element contained a bit too much logic. Making use of a helper seems a good step forwards.... I think I feel a refactoring coming on :)</p>
<p>Cheers,</p>
<p>AD
</p>
</div>
	</div>
		<div class="comment snook" id="c50113">
		<div class="meta">
			<div class="commentnumber"><a href="#c50113">7</a></div>
			<span class="authorname">Jonathan Snook</span> said on June 26, 2007		</div>
		<div class="quote"><p>@Andy: currently, I don't have any convention. I suppose, like this Elemental script, I should contain it within a single namespace of sorts. Now that I have this script, I'm more likely to use it because of the way it easily ties components and elements together. Otherwise, conflict is always possible and hopefully your naming convention is clear and unique enough not to be a problem.
</p>
</div>
	</div>
		<div class="comment" id="c50789">
		<div class="meta">
			<div class="commentnumber"><a href="#c50789">8</a></div>
			<span class="authorname"><a href="http://stephenminded.com/">Steve Lounsbury</a></span> said on July 06, 2007		</div>
		<div class="quote"><p>I can see using this in a CMS, allowing the user to define what elements show in a sidebar (similar to the sidebar widgets in wordpress 2.2). It would be a pretty simple modification to make. Thanks again for the inspiration!
</p>
</div>
	</div>
		<div class="comment" id="c51955">
		<div class="meta">
			<div class="commentnumber"><a href="#c51955">9</a></div>
			<span class="authorname">Dan Cramer</span> said on July 18, 2007		</div>
		<div class="quote"><p>Great piece of information. Thanks for putting this out there for the cake community.
</p>
</div>
	</div>
		<div class="comment" id="c52061">
		<div class="meta">
			<div class="commentnumber"><a href="#c52061">10</a></div>
			<span class="authorname">Kjell Bublitz</span> said on July 19, 2007		</div>
		<div class="quote"><p>Interesting approach. I like it :) </p>
<p>What do think about assigning the params for renderElement from within the enable method? Saving you the $this-&gt;set() .. </p>
<p>f.e. $this-&gt;enableElement('projects', $projectData);<br />
in the helper.. $view-&gt;viewVars['elements'][$element] = array( with the data ) = $params</p>
</div>
	</div>
		<div class="comment snook" id="c52068">
		<div class="meta">
			<div class="commentnumber"><a href="#c52068">11</a></div>
			<span class="authorname">Jonathan Snook</span> said on July 19, 2007		</div>
		<div class="quote"><p>@Kjell Bublitz: That is a good idea. I like it! I'm also thinking of looking into turning the controller methods into a component of its own so that it's more "drag and drop" for any project. If I get to that, I'll see about submitting it to the Bakery.
</p>
</div>
	</div>
		<div class="comment" id="c52222">
		<div class="meta">
			<div class="commentnumber"><a href="#c52222">12</a></div>
			<span class="authorname">C. James Callaway</span> said on July 21, 2007		</div>
		<div class="quote"><p>I have implemented something similar.  I've added a table to the database to maintain sidebar blocks.  Each record contains, controller, action, helper, helper_method, sort_order.  In app_controller.php, in beforeRender, I query the database to get a list of blocks based on $this-&gt;params.  Derived controllers can override this behavior by setting a flag (renderBlocks).  Helper::helper_method gets called from app/views/layout/mysite.thtml</p>
</div>
	</div>
		<div class="comment" id="c59863">
		<div class="meta">
			<div class="commentnumber"><a href="#c59863">13</a></div>
			<span class="authorname">Peter Jacobson</span> said on October 20, 2008		</div>
		<div class="quote"><p>Found this copy of your article elsewhere, with no attribution, thought you might want to know. Thanks for the original one though... (spaces etc inserted into link on purpose)</p>
<p><code><br />
http://www dot designfloat dot com / Programming / Elemental_Conditional_Content_with_CakePHP/<br />
</code>
</p>
</div>
	</div>
		


		<div id="commentsclosed">Sorry, comments are closed for this post. If you have any further questions or
	comments, feel free to <a href="https://snook.ca/contact/">send them to me directly</a>.</div>
	</div>
	</div>
	</div>
	<div id="footer">
		<div id="copyright"><div class="shell">
<p class="blurb"> Hi. My name is Jonathan Snook and this is my site. I write about what interests me, which is usually web design, development, and technology. I'm also in the middle of a <a href="https://fifty.snook.ca/">food adventure</a> and I like <a href="https://nook.snook.ca/">whisky</a>.
    <span>I wrote <a href="http://smacss.com/">SMACSS</a>.  I <a href="http://twitter.com/snookca">tweet</a>. Want to <a href="https://snook.ca/about/">learn more</a>? </span>
</p>
			<p>&copy; Jonathan Snook</p>
		</div></div>
	</div>
</body>

<!-- Mirrored from snook.ca/archives/cakephp/elemental_conditional_content_with_cakephp by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 25 Apr 2021 22:04:57 GMT -->
</html>
