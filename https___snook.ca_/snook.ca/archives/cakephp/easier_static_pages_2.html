<!doctype html>
<html lang="en">

<!-- Mirrored from snook.ca/archives/cakephp/easier_static_pages_2 by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 25 Apr 2021 22:04:55 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
	<title>Easier Static Pages for CakePHP 1.2 Update - Snook.ca</title>
	<meta name="viewport" content="width=device-width" />
		<link rev="canonical" type="text/html" href="https://snook.ca/archives/cakephp/easier_static_pages_2">
	<meta property="og:url" content="https://snook.ca/archives/cakephp/easier_static_pages_2">
	<meta property="og:title" content="Easier Static Pages for CakePHP 1.2 Update">
	<meta property="og:description" name="description" content="So it seems that the old code I had didn't work in debug mode, although on the current CakePHP 1.2 RC2, I'm not even sure it works at all. However, I decided to take some time to revisit the code. Las...">
	<meta property="og:type" content="article">
				<meta property="og:image" content="https://snk.ms/logo.gif">
		<meta name="twitter:card" content="summary">
				<meta name="theme-color" content="#680">
	<link rel="alternate" type="application/rss+xml" title="XML" href="https://snook.ca/jonathan/index.rdf"> 
<!--	<link rel="stylesheet" href="/css/snook-v10.css"> -->
<style>
/* A font by Jos Buivenga (exljbris) -> http://www.exljbris.nl */

@font-face { font-family: 'MuseoCustom'; src: url('https://snook.ca/css/MuseoSans_500-webfont.woff2') format('woff2'), url('https://snook.ca/css/MuseoSans_500-webfont.woff') format('woff'); font-weight: normal; font-style: normal; }
@font-face { font-family: 'Playfair Display'; font-style: normal; font-weight: 900; src: local('Playfair Display Black'), local('PlayfairDisplay-Black'), url('https://snook.ca/css/playfair.woff2') format('woff2'), url(https://fonts.gstatic.com/s/playfairdisplay/v10/UC3ZEjagJi85gF9qFaBgIFG5nCscAKpKP81nraB-v6E.woff) format('woff'); unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215; }
html{background:#EEEEE6 url(https://snook.ca/img/bg.png)}body{margin:0;padding:0;border:12px solid #680;font-family:'PT Serif',Georgia,Times,'Times New Roman',serif;background:url(https://snook.ca/img/swash.svg) no-repeat 50% 0;background-size:1600px 200px;color:#333;line-height:1.7;min-height:calc(100vh - 24px)}img{border:0}figcaption{font-style:italic;font-size:90%;}p{margin-bottom:1.5em}hr{width:20%;}a{color:#680;transition:all .2s}a:hover{text-decoration:none}a:active,a:focus{background-color:rgba(51,51,51,.1)}blockquote{font-style:italic;font-size:95%;background:url(https://snook.ca/img/comment.svg) no-repeat 2px 5px;margin:0;padding-left:20px}pre{margin-left:-20px;background:url(https://snook.ca/img/code-bookmark.svg) no-repeat 0 0}pre code{display:block;margin-left:20px;padding:10px;font-size:90%;background-color:rgba(255,255,255,.5);overflow:auto}table{border:1px solid #666;border-width:1px 0;border-collapse:collapse;background-color:rgba(255,255,255,.5);margin-bottom:30px;font-size:90%}th{border:1px solid #666;border-width:1px 0;background-color:rgba(51,51,51,.1)}td{border:1px solid #CCC;border-width:1px 0;padding:2px 10px}.update{background-color:rgba(33,129,66,0.1);padding:5px 10px 1px;border-radius:5px}#header{font-family:'MuseoCustom','Century Gothic',Arial,Helvetica,sans-serif;font-size:13px;max-width:780px;margin:auto;line-height:12px;background:url(https://snook.ca/img/snook-bookmark.svg) no-repeat;padding:0 20px}#header h1,#header h2{font-size:13px;font-weight:400;margin:0}#header h1{color:#680;padding-top:18px;text-transform:uppercase}#header h2 a{text-decoration:none;color:#333;display:block}#header h2 a:hover{color:#680}#header .nav{text-transform:uppercase;word-spacing:4px;padding-top:20px}#header .nav a{text-decoration:none;color:#333;padding-top:3px}#header .nav a:hover{color:#680}.blurb{line-height:1.3}#content{max-width:820px;margin:4em auto;background:url(https://snook.ca/img/star.svg) no-repeat 3px 58px}#main{padding:40px 0 0;background:url(https://snook.ca/img/line-v.png) no-repeat 100% 90%}#main .dt,#main .cat,#main .shorturl{font-family:Garamond,Georgia,Times,'Times New Roman',serif;text-transform:uppercase;font-size:13px;font-weight:700;color:#666;background:url(https://snook.ca/img/line.png) no-repeat -200px 70%}#main h2{font-weight:900;font-size:28px;margin:7px 0 0;font-family:'Playfair Display',Garamond,serif;line-height:1.1;background:url(https://snook.ca/img/line.png) no-repeat 100px 26px}#main h2 a{text-decoration:none;color:#444}#main h2 a:hover{color:#680}.article-image-small{margin-top:20px;text-align:center;background-color:#000;padding:6px;font-size:0;display:inline-block;}.article-image{text-align:center;background-color:rgba(0,0,0,.07);padding:14px 12px;font-size:0px;width:calc(100vw - 24px);position:relative;left:50%;right:50%;margin:20px -50vw 4rem -50vw;}#main .article.inside h1{font-weight:900;font-size:2em;margin:0 0 2em;font-family:'Playfair Display',Garamond,serif;line-height:40px;background:url(https://snook.ca/img/line.png) no-repeat 100px 90%}#main .article.inside h2{font-family:'Playfair Display',Georgia,Times,'Times New Roman',serif;font-weight:900;font-size:1.5em;text-transform:none;background:none}@media only screen and (min-width: 480px){#main .article.inside{font-size:120%}}#main .article{margin-bottom:40px;padding:0 20px;background:url(https://snook.ca/img/star.svg) no-repeat 2px 13px}#main .article:first-child{background:none}#main .article img{max-width:100%;max-height:80vh;}#main .article .abstract{font-size:110%;}#main .fullarticle{text-align:right;background:url(https://snook.ca/img/line.png) no-repeat 190% 70%}#main .fullarticle a{text-transform:uppercase;text-decoration:none;color:#680;font-size:14px;padding:4px}#main .fullarticle a:hover{background-color:rgba(51,51,51,.1)}#main .meta{background:url(https://snook.ca/img/star.svg) no-repeat 3px .3em;font-family:Garamond,Georgia,Times,'T\Aimes New Roman',serif;padding-left:20px;margin-top:40px}#main .shorturl .url{text-transform:none;color:#555}#comments .meta{background:url(https://snook.ca/img/comment-bookmark.svg) no-repeat 0 3px}#comments .comment{background:url(https://snook.ca/img/comment.svg) no-repeat 3px .6em}#comments .comment .meta .authorname{text-transform:uppercase}#comments .comment .meta .commentnumber a{float:right;color:rgba(51,51,51,.25);font-size:24px;text-decoration:none}#comments .comment .quote{padding-left:20px;font-size:95%;word-break:break-word}#comments .commentcount{text-transform:uppercase}#comments .comment .meta{background:url(https://snook.ca/img/line.png) no-repeat 40px 1.1em}#comments .snook{background:url(https://snook.ca/img/comment-snook.png) no-repeat 0 3px}#comments .snook .meta .commentnumber a{color:rgba(102,136,0,.5)}#comments .snook .meta .commentnumber a:hover{color:rgba(102,136,0,1)}h3#postcomments{text-transform:uppercase;font-weight:400;font-size:14px;background:url(https://snook.ca/img/line.png) no-repeat 40px 14px;margin:0 20px}#comments_form{background:url(https://snook.ca/img/line-v.png) no-repeat 10px 0;padding-left:20px}#comments_form .inputgroup{background:url(https://snook.ca/img/line.png) no-repeat 100% 100%;margin-bottom:5px}#postmeta{margin-bottom:10px}#postdata{background:url(https://snook.ca/img/line-v.png) no-repeat 100% 50%}#postdata textarea{width:100%;border:none;font-size:inherit;font-family:inherit;padding:10px;box-sizing:border-box}#postmeta label{width:80px;display:block;float:left;text-transform:uppercase;font-size:10px}#postmeta input{border:none;max-width:407px}#comments_form .formnote{font-size:80%}#commentsclosed{padding:10px;margin:20px 0;background:rgba(51,51,51,.1)}#livepreview{display:none}#main .article ul.projects{list-style:none;margin:0;padding:0;overflow:hidden}ul.projects li{margin:0 10px 20px 0;padding:0;float:left;width:240px;line-height:15px;list-style:none}ul.projects li img{float:left;margin-right:5px;border:5px solid #CCC}ul.projects li a:hover img{border-color:#BBCF7F}ul.projects li span{display:block;font-size:12px}#footer{clear:both;font-size:90%;margin-bottom:-12px;}#footer .shell{max-width:770px;margin:auto;}#footer #copyright p{font-family:MuseoCustom,Helvetica,sans-serif}#footer #copyright .shell{padding:0 25px 200px;background:url(https://snook.ca/img/PolySnook.svgo.svg) no-repeat 50% 120%;background-size:400px 250px}iframe{max-width:100%;}
</style>
	<link rel="stylesheet" href="https://snook.ca/css/snook-v10-print.css" media="print">	
</head>
<body>
	<div id="header">
		<h1>Snook.ca</h1>
		<h2><a href="https://snook.ca/">LIFE &amp; TIMES of a WEB DEVELOPER</a></h2>
		<div class="nav"><a href="https://snook.ca/about/">About</a> &middot;  <a href="https://snook.ca/contact/">Contact</a> &middot; <a href="https://snook.ca/archives/">Archives</a></div>

	</div>
	<div id="content">
	<div id="main">
		<div class="article inside">
	
	<h1>Easier Static Pages for CakePHP 1.2 Update</h1>
		<p>So it seems that the old code I had didn't work in debug mode, although on the current CakePHP 1.2 RC2, I'm not even sure it works at all. However, I decided to take some time to revisit the code. Last time, I simply hacked up the missingAction and missingController calls and it felt kludgy. It looked kludgy. </p>
<p>This time I took a closer look at how the dispatch was being handled. Daniel Hofstetter made <a href="http://cakebaker.42dh.com/2008/06/18/an-alternative-approach-for-static-pages/">mentioned how using the error handler seemed inappropriate</a> since it's for handling errors. Unfortunately, the Dispatcher looks for a missing action or controller and if it can't find them, it sends it off to the AppError class well before anything else. As a result, it seems that overriding the AppError is really the approach that I want to take. I think you'll see, though, that the new code is more straightforward.</p>
<p>It uses the constructor to capture what kind of error is being called. If it's a missingAction or missingController then I look for the missing file. If the file doesn't exist, the flow continues on to the parent error class and the missingAction and missingController calls happen as they normally would. The old code actually handled both scenarios creating bulky code. </p>
<p>If the page exists then the AppController is instantiated and the view is rendered. The <em>only</em> problem currently is that CakePHP doesn't seem to load the custom AppController, if it exists. I've <a href="https://trac.cakephp.org/ticket/5052">filed a ticket</a> but I'm not entirely sure if this is by design, so this may not ultimately get resolved.</p>
<p>Without further ado, here's my AppError:</p>
<pre><code>class AppError extends ErrorHandler {

	function __construct($method, $messages) {

		$params = Router::getParams();

		if (($method == 'missingController' || $method == 'missingAction') 
           && file_exists(VIEWS . DS . $params['controller'] . DS . $params['action'] . ".ctp")) {
			$this-&gt;controller =& new AppController();
			$this-&gt;controller->_set(Router::getPaths());
			$this-&gt;controller->params = $params;
			$this-&gt;controller->constructClasses();
			$this-&gt;controller->viewPath = $params['controller'];
			$this-&gt;controller->render($params['action']);
			e($this-&gt;controller->output);
			exit;
		}

		parent::__construct($method, $messages);
		exit();
	}

}</code></pre>	
</div>
<div class="meta">
	<div class="dt">Published July 04, 2008 </div>
	<div class="cat">Categorized as <a href="https://snook.ca/archives/cakephp/">CakePHP</a></div>
	<div class="shorturl">Short URL: <span class="url">https://snook.ca/s/899</span></div>
</div>

<div id="comments">
	<div class="meta">
		<h2>Conversation</h2>
		<div class="commentcount">8 Comments &middot; <a href="https://snook.ca/archives/cakephp/easier_static_pages_2.rss">RSS feed</a></div>
		<div class="commentfeed"></div>
	</div>
	
		<div class="comment" id="c58956">
		<div class="meta">
			<div class="commentnumber"><a href="#c58956">1</a></div>
			<span class="authorname">Jason</span> said on July 05, 2008		</div>
		<div class="quote"><p>Thank you, this code works great with the debug now, and is much easier to understand. I can confirm that it also works with cake 1.2 rc2. Your code worked fine in cake 1.2 beta, but when I added in my own code for checking a pages database I had some problems. It was a known bug where sessions were not getting initiallized again or something. Anyway, that seems to have been fixed in later versions of cake.
</p>
</div>
	</div>
		<div class="comment snook" id="c58957">
		<div class="meta">
			<div class="commentnumber"><a href="#c58957">2</a></div>
			<span class="authorname">Jonathan Snook</span> said on July 05, 2008		</div>
		<div class="quote"><p>I'm happy to hear it works!</p>
<p>One quick note, that ticket I filed was invalid. It works on the latest version from svn. My dev copy must've been slightly older. So there should be no issues adding in functionality from AppController.
</p>
</div>
	</div>
		<div class="comment" id="c59000">
		<div class="meta">
			<div class="commentnumber"><a href="#c59000">3</a></div>
			<span class="authorname">avto</span> said on July 11, 2008		</div>
		<div class="quote"><p>Thank you!<br />
very very nice!
</p>
</div>
	</div>
		<div class="comment" id="c59123">
		<div class="meta">
			<div class="commentnumber"><a href="#c59123">4</a></div>
			<span class="authorname">Matti putkonen</span> said on August 09, 2008		</div>
		<div class="quote"><p>Awesome work Jonathan, I hope they add this type of functionality to core in the future.</p>
<p>Do you see any problems with setting all of these view to be stored in one view directory, like 'static', if they are not related to a controller in any way ?
</p>
</div>
	</div>
		<div class="comment" id="c59658">
		<div class="meta">
			<div class="commentnumber"><a href="#c59658">5</a></div>
			<span class="authorname">jamie scott</span> said on September 28, 2008		</div>
		<div class="quote"><p>Thanks for this code. Any idea how I can make routing work with a .html suffix and still get the url caught by your error system?
</p>
</div>
	</div>
		<div class="comment" id="c60942">
		<div class="meta">
			<div class="commentnumber"><a href="#c60942">6</a></div>
			<span class="authorname">Mark</span> said on January 11, 2009		</div>
		<div class="quote"><p>Jonathan,</p>
<p>"...there should be no issues adding in functionality from AppController"</p>
<p>Have you figured out how to get missing controllers to load components (specifically, the Auth component)? Or rather, have it use the AppController as usual?
</p>
</div>
	</div>
		<div class="comment snook" id="c60948">
		<div class="meta">
			<div class="commentnumber"><a href="#c60948">7</a></div>
			<span class="authorname">Jonathan Snook</span> said on January 11, 2009		</div>
		<div class="quote"><p>Mark: assuming things haven't regressed since I posted this, if you've specified the Auth component in AppController, it should be used.
</p>
</div>
	</div>
		<div class="comment" id="c60949">
		<div class="meta">
			<div class="commentnumber"><a href="#c60949">8</a></div>
			<span class="authorname">Mark</span> said on January 11, 2009		</div>
		<div class="quote"><p>I guess things have regressed then (using 1.2 stable now). As a quick test, I added an echo to the beforeFilter in AppController. It's displayed on all pages where the controller is specified, but not when there's a missing controller.
</p>
</div>
	</div>
		


		<div id="commentsclosed">Sorry, comments are closed for this post. If you have any further questions or
	comments, feel free to <a href="https://snook.ca/contact/">send them to me directly</a>.</div>
	</div>
	</div>
	</div>
	<div id="footer">
		<div id="copyright"><div class="shell">
<p class="blurb"> Hi. My name is Jonathan Snook and this is my site. I write about what interests me, which is usually web design, development, and technology. I'm also in the middle of a <a href="https://fifty.snook.ca/">food adventure</a> and I like <a href="https://nook.snook.ca/">whisky</a>.
    <span>I wrote <a href="http://smacss.com/">SMACSS</a>.  I <a href="http://twitter.com/snookca">tweet</a>. Want to <a href="https://snook.ca/about/">learn more</a>? </span>
</p>
			<p>&copy; Jonathan Snook</p>
		</div></div>
	</div>
</body>

<!-- Mirrored from snook.ca/archives/cakephp/easier_static_pages_2 by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 25 Apr 2021 22:04:55 GMT -->
</html>
