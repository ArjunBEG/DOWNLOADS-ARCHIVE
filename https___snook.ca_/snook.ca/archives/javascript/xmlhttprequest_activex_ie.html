<!doctype html>
<html lang="en">

<!-- Mirrored from snook.ca/archives/javascript/xmlhttprequest_activex_ie by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 25 Apr 2021 22:04:56 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
	<title>Microsoft's XMLHttpRequest ActiveX Objects - Snook.ca</title>
	<meta name="viewport" content="width=device-width" />
		<link rev="canonical" type="text/html" href="https://snook.ca/archives/javascript/xmlhttprequest_activex_ie">
	<meta property="og:url" content="https://snook.ca/archives/javascript/xmlhttprequest_activex_ie">
	<meta property="og:title" content="Microsoft's XMLHttpRequest ActiveX Objects">
	<meta property="og:description" name="description" content="This is an excerpt from my book, Accelerated DOM Scripting available at Amazon and other fine retailers. Although it's only a small section of the book, it's one of my favourite pieces because it had ...">
	<meta property="og:type" content="article">
				<meta property="og:image" content="https://snk.ms/logo.gif">
		<meta name="twitter:card" content="summary">
				<meta name="theme-color" content="#680">
	<link rel="alternate" type="application/rss+xml" title="XML" href="https://snook.ca/jonathan/index.rdf"> 
<!--	<link rel="stylesheet" href="/css/snook-v10.css"> -->
<style>
/* A font by Jos Buivenga (exljbris) -> http://www.exljbris.nl */

@font-face { font-family: 'MuseoCustom'; src: url('https://snook.ca/css/MuseoSans_500-webfont.woff2') format('woff2'), url('https://snook.ca/css/MuseoSans_500-webfont.woff') format('woff'); font-weight: normal; font-style: normal; }
@font-face { font-family: 'Playfair Display'; font-style: normal; font-weight: 900; src: local('Playfair Display Black'), local('PlayfairDisplay-Black'), url('https://snook.ca/css/playfair.woff2') format('woff2'), url(https://fonts.gstatic.com/s/playfairdisplay/v10/UC3ZEjagJi85gF9qFaBgIFG5nCscAKpKP81nraB-v6E.woff) format('woff'); unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215; }
html{background:#EEEEE6 url(https://snook.ca/img/bg.png)}body{margin:0;padding:0;border:12px solid #680;font-family:'PT Serif',Georgia,Times,'Times New Roman',serif;background:url(https://snook.ca/img/swash.svg) no-repeat 50% 0;background-size:1600px 200px;color:#333;line-height:1.7;min-height:calc(100vh - 24px)}img{border:0}figcaption{font-style:italic;font-size:90%;}p{margin-bottom:1.5em}hr{width:20%;}a{color:#680;transition:all .2s}a:hover{text-decoration:none}a:active,a:focus{background-color:rgba(51,51,51,.1)}blockquote{font-style:italic;font-size:95%;background:url(https://snook.ca/img/comment.svg) no-repeat 2px 5px;margin:0;padding-left:20px}pre{margin-left:-20px;background:url(https://snook.ca/img/code-bookmark.svg) no-repeat 0 0}pre code{display:block;margin-left:20px;padding:10px;font-size:90%;background-color:rgba(255,255,255,.5);overflow:auto}table{border:1px solid #666;border-width:1px 0;border-collapse:collapse;background-color:rgba(255,255,255,.5);margin-bottom:30px;font-size:90%}th{border:1px solid #666;border-width:1px 0;background-color:rgba(51,51,51,.1)}td{border:1px solid #CCC;border-width:1px 0;padding:2px 10px}.update{background-color:rgba(33,129,66,0.1);padding:5px 10px 1px;border-radius:5px}#header{font-family:'MuseoCustom','Century Gothic',Arial,Helvetica,sans-serif;font-size:13px;max-width:780px;margin:auto;line-height:12px;background:url(https://snook.ca/img/snook-bookmark.svg) no-repeat;padding:0 20px}#header h1,#header h2{font-size:13px;font-weight:400;margin:0}#header h1{color:#680;padding-top:18px;text-transform:uppercase}#header h2 a{text-decoration:none;color:#333;display:block}#header h2 a:hover{color:#680}#header .nav{text-transform:uppercase;word-spacing:4px;padding-top:20px}#header .nav a{text-decoration:none;color:#333;padding-top:3px}#header .nav a:hover{color:#680}.blurb{line-height:1.3}#content{max-width:820px;margin:4em auto;background:url(https://snook.ca/img/star.svg) no-repeat 3px 58px}#main{padding:40px 0 0;background:url(https://snook.ca/img/line-v.png) no-repeat 100% 90%}#main .dt,#main .cat,#main .shorturl{font-family:Garamond,Georgia,Times,'Times New Roman',serif;text-transform:uppercase;font-size:13px;font-weight:700;color:#666;background:url(https://snook.ca/img/line.png) no-repeat -200px 70%}#main h2{font-weight:900;font-size:28px;margin:7px 0 0;font-family:'Playfair Display',Garamond,serif;line-height:1.1;background:url(https://snook.ca/img/line.png) no-repeat 100px 26px}#main h2 a{text-decoration:none;color:#444}#main h2 a:hover{color:#680}.article-image-small{margin-top:20px;text-align:center;background-color:#000;padding:6px;font-size:0;display:inline-block;}.article-image{text-align:center;background-color:rgba(0,0,0,.07);padding:14px 12px;font-size:0px;width:calc(100vw - 24px);position:relative;left:50%;right:50%;margin:20px -50vw 4rem -50vw;}#main .article.inside h1{font-weight:900;font-size:2em;margin:0 0 2em;font-family:'Playfair Display',Garamond,serif;line-height:40px;background:url(https://snook.ca/img/line.png) no-repeat 100px 90%}#main .article.inside h2{font-family:'Playfair Display',Georgia,Times,'Times New Roman',serif;font-weight:900;font-size:1.5em;text-transform:none;background:none}@media only screen and (min-width: 480px){#main .article.inside{font-size:120%}}#main .article{margin-bottom:40px;padding:0 20px;background:url(https://snook.ca/img/star.svg) no-repeat 2px 13px}#main .article:first-child{background:none}#main .article img{max-width:100%;max-height:80vh;}#main .article .abstract{font-size:110%;}#main .fullarticle{text-align:right;background:url(https://snook.ca/img/line.png) no-repeat 190% 70%}#main .fullarticle a{text-transform:uppercase;text-decoration:none;color:#680;font-size:14px;padding:4px}#main .fullarticle a:hover{background-color:rgba(51,51,51,.1)}#main .meta{background:url(https://snook.ca/img/star.svg) no-repeat 3px .3em;font-family:Garamond,Georgia,Times,'T\Aimes New Roman',serif;padding-left:20px;margin-top:40px}#main .shorturl .url{text-transform:none;color:#555}#comments .meta{background:url(https://snook.ca/img/comment-bookmark.svg) no-repeat 0 3px}#comments .comment{background:url(https://snook.ca/img/comment.svg) no-repeat 3px .6em}#comments .comment .meta .authorname{text-transform:uppercase}#comments .comment .meta .commentnumber a{float:right;color:rgba(51,51,51,.25);font-size:24px;text-decoration:none}#comments .comment .quote{padding-left:20px;font-size:95%;word-break:break-word}#comments .commentcount{text-transform:uppercase}#comments .comment .meta{background:url(https://snook.ca/img/line.png) no-repeat 40px 1.1em}#comments .snook{background:url(https://snook.ca/img/comment-snook.png) no-repeat 0 3px}#comments .snook .meta .commentnumber a{color:rgba(102,136,0,.5)}#comments .snook .meta .commentnumber a:hover{color:rgba(102,136,0,1)}h3#postcomments{text-transform:uppercase;font-weight:400;font-size:14px;background:url(https://snook.ca/img/line.png) no-repeat 40px 14px;margin:0 20px}#comments_form{background:url(https://snook.ca/img/line-v.png) no-repeat 10px 0;padding-left:20px}#comments_form .inputgroup{background:url(https://snook.ca/img/line.png) no-repeat 100% 100%;margin-bottom:5px}#postmeta{margin-bottom:10px}#postdata{background:url(https://snook.ca/img/line-v.png) no-repeat 100% 50%}#postdata textarea{width:100%;border:none;font-size:inherit;font-family:inherit;padding:10px;box-sizing:border-box}#postmeta label{width:80px;display:block;float:left;text-transform:uppercase;font-size:10px}#postmeta input{border:none;max-width:407px}#comments_form .formnote{font-size:80%}#commentsclosed{padding:10px;margin:20px 0;background:rgba(51,51,51,.1)}#livepreview{display:none}#main .article ul.projects{list-style:none;margin:0;padding:0;overflow:hidden}ul.projects li{margin:0 10px 20px 0;padding:0;float:left;width:240px;line-height:15px;list-style:none}ul.projects li img{float:left;margin-right:5px;border:5px solid #CCC}ul.projects li a:hover img{border-color:#BBCF7F}ul.projects li span{display:block;font-size:12px}#footer{clear:both;font-size:90%;margin-bottom:-12px;}#footer .shell{max-width:770px;margin:auto;}#footer #copyright p{font-family:MuseoCustom,Helvetica,sans-serif}#footer #copyright .shell{padding:0 25px 200px;background:url(https://snook.ca/img/PolySnook.svgo.svg) no-repeat 50% 120%;background-size:400px 250px}iframe{max-width:100%;}
</style>
	<link rel="stylesheet" href="https://snook.ca/css/snook-v10-print.css" media="print">	
</head>
<body>
	<div id="header">
		<h1>Snook.ca</h1>
		<h2><a href="https://snook.ca/">LIFE &amp; TIMES of a WEB DEVELOPER</a></h2>
		<div class="nav"><a href="https://snook.ca/about/">About</a> &middot;  <a href="https://snook.ca/contact/">Contact</a> &middot; <a href="https://snook.ca/archives/">Archives</a></div>

	</div>
	<div id="content">
	<div id="main">
		<div class="article inside">
	
	<h1>Microsoft's XMLHttpRequest ActiveX Objects</h1>
		<p><em>This is an excerpt from my book, <a href="http://www.amazon.com/gp/product/1590597648/702-3295721-8680041?ie=UTF8&amp;tag=snookca0f-20&amp;linkCode=xm2&amp;camp=15121&amp;creativeASIN=1590597648">Accelerated DOM Scripting</a></em> <em>available at Amazon and other fine retailers. Although it's only a small section of the book, it's one of my favourite pieces because it had always been a mystery to me. </em></p>
<p>If you&rsquo;ve scoured through any number of  Ajax solutions,  you might have noticed different XMLHttpRequest objects being referred to. Microsoft&rsquo;s XML implementation is known  as MSXML and comes in many versions.</p>
<p>  Here&rsquo;s the list:</p>
<ul>
  <li> Microsoft.XMLHTTP </li>
  <li> Msxml2.XMLHTTP</li>
  <li> Msxml2.XMLHTTP.3.0</li>
  <li> Msxml2.XMLHTTP.4.0</li>
  <li>Msxml2.XMLHTTP.5.0</li>
  <li>Msxml2.XMLHTTP.6.0 </li>
</ul>
<p>  An <a href="http://blogs.msdn.com/xmlteam/archive/2006/10/23/using-the-right-version-of-msxml-in-internet-explorer.aspx">article from the Microsoft XML team</a>  explains in some detail the differences between what the different versions are  and how they should be used (but it&rsquo;s still not entirely clear).</p>
<p>  MSXML 1.0 and 2.0 are no longer supported  by Microsoft. Version 4.0 never saw an operating system release, and version 5.0  was a special version for Microsoft Office. The version-independent IDs,  Microsoft.XMLHTTP and Msxml2.XMLHTTP, now map directly to version 3.0 (even if  version 6.0 is installed). This really only leaves you with two possible  program IDs (referred to as progIDs by Microsoft):</p>
<ul>
  <li> Msxml2.XMLHTTP</li>
  <li> Msxml2.XMLHTTP.6.0</li>
</ul>
<p>  Version 6 was introduced in IE 7 and  includes some bug fixes such as the one where IE 5 and 6 fail  when the onreadystatechange is declared before the open call.  Although IE 7 includes a native XHR object, users have the option of disabling  it. Therefore, it&rsquo;s a good idea to test for Msxml2.XMLHTTP.6.0 first; if it  doesn&rsquo;t work, fall back to the other version. </p>
<p>Here's a quick example checking for the native object before checking for the IE-specific versions:</p>
<pre><code>/**
   Will return a valid object if successful
*/
function XHR()
{
  var transport;
  // check native support first
  if(window.XMLHttpRequest) {
    transport = new XMLHttpRequest();
  }else{
    // check for version 6 before version 3
    try{ transport = new ActiveXObject("MSXML2.XMLHTTP.6.0");  }catch(e){}
    try{ if(!transport) transport = new ActiveXObject("MSXML2.XMLHTTP");  }catch(e){}
  }
  return transport;
}</code></pre>	
</div>
<div class="meta">
	<div class="dt">Published January 21, 2008 </div>
	<div class="cat">Categorized as <a href="https://snook.ca/archives/javascript/">JavaScript</a></div>
	<div class="shorturl">Short URL: <span class="url">https://snook.ca/s/865</span></div>
</div>

<div id="comments">
	<div class="meta">
		<h2>Conversation</h2>
		<div class="commentcount">12 Comments &middot; <a href="https://snook.ca/archives/javascript/xmlhttprequest_activex_ie.rss">RSS feed</a></div>
		<div class="commentfeed"></div>
	</div>
	
		<div class="comment" id="c57260">
		<div class="meta">
			<div class="commentnumber"><a href="#c57260">1</a></div>
			<span class="authorname">Robert Nyman</span> said on January 21, 2008		</div>
		<div class="quote"><p>It's good to have these listed. and to understand what they really are!<br />
Nitpicking, just one small thing: given Douglas Crockford's and others' advice, do you really want the starting <code>{</code> on a separate line?</p>
<p>Short example: <a href="http://remysharp.com/2007/11/21/javascript-style-why-its-important/">JavaScript Style - why itâ€™s important</a>
</p>
</div>
	</div>
		<div class="comment snook" id="c57261">
		<div class="meta">
			<div class="commentnumber"><a href="#c57261">2</a></div>
			<span class="authorname">Jonathan Snook</span> said on January 21, 2008		</div>
		<div class="quote"><p>Yes, I still prefer putting the { on a new line. I find it easier for seeing where my functions start and end. For <code>return</code>s, I don't like returning an object literal, so I'll always assign it to a variable and then return the variable. I find the code more readable that way and, as it turns out, avoids the issue described.
</p>
</div>
	</div>
		<div class="comment" id="c57262">
		<div class="meta">
			<div class="commentnumber"><a href="#c57262">3</a></div>
			<span class="authorname">Chris A</span> said on January 21, 2008		</div>
		<div class="quote"><pre><code>
try{ transport = new ActiveXObject("MSXML2.XMLHTTP.6.0");  }catch(e){}
try{ transport = new ActiveXObject("MSXML2.XMLHTTP");  }catch(e){}

</code></pre>
<p>Shouldn't the order of those lines be reversed? That way IE7 users with the XHR object disabled will get the 6.0 instead of the 3.0. Or am I not following? It seems to me that, in IE7 with XHR disabled, the first statement will succeed and the transport variable will reference the 6.0 version. And then the second statement will also succeed and the transport variable will now reference the 3.0 version.
</p>
</div>
	</div>
		<div class="comment snook" id="c57263">
		<div class="meta">
			<div class="commentnumber"><a href="#c57263">4</a></div>
			<span class="authorname">Jonathan Snook</span> said on January 21, 2008		</div>
		<div class="quote"><p>@Chris A: Good catch. I've updated the code example in the article with an IF check in the second TRY statement. (Now to put together my first errata for the book...)
</p>
</div>
	</div>
		<div class="comment" id="c57265">
		<div class="meta">
			<div class="commentnumber"><a href="#c57265">5</a></div>
			<span class="authorname">Chris Lienert</span> said on January 21, 2008		</div>
		<div class="quote"><p>I usually return the object as soon as possible i.e.</p>
<pre><code>try {
  return new ActiveXObject("Msxml2.XMLHTTP.6.0");
} catch(e) {
  try {
    return new ActiveXObject("Msxml2.XMLHTTP");
  } catch(e) {
    return null;
  }
}</pre>
<p></code>
</p>
</div>
	</div>
		<div class="comment" id="c57266">
		<div class="meta">
			<div class="commentnumber"><a href="#c57266">6</a></div>
			<span class="authorname"><a href="http://www.robertnyman.com/">Robert Nyman</a></span> said on January 22, 2008		</div>
		<div class="quote"><p>Yes, that solves that specific issue. But to me, at least, it seems like sound advice to always have it on the same line as the code, to avoid any potential hazards with semi-colons inserted automatically by the interpretor.
</p>
</div>
	</div>
		<div class="comment" id="c57268">
		<div class="meta">
			<div class="commentnumber"><a href="#c57268">7</a></div>
			<span class="authorname">Terry Apodaca</span> said on January 22, 2008		</div>
		<div class="quote"><p>Very nice!
</p>
</div>
	</div>
		<div class="comment" id="c57299">
		<div class="meta">
			<div class="commentnumber"><a href="#c57299">8</a></div>
			<span class="authorname">Greg Ferrell</span> said on January 23, 2008		</div>
		<div class="quote"><p>Robert,</p>
<p>There are no known issues with having your beginning bracket on a new line and accidental semi-colon insertion when dealing with functions, for/while-loops, if/then statements, etc in JavaScript. Even Crockford does some of his code this way.</p>
<p>The issue comes into focus when you are dealing with objects.
</p>
</div>
	</div>
		<div class="comment" id="c57300">
		<div class="meta">
			<div class="commentnumber"><a href="#c57300">9</a></div>
			<span class="authorname">Greg Ferrell</span> said on January 23, 2008		</div>
		<div class="quote"><p>I should correct my last statement above to say:</p>
<p>The issue comes into focus when you are dealing with literals.</p>
<p>Breaking after a parenthesis is perfectly fine.
</p>
</div>
	</div>
		<div class="comment" id="c57329">
		<div class="meta">
			<div class="commentnumber"><a href="#c57329">10</a></div>
			<span class="authorname">Dan</span> said on January 24, 2008		</div>
		<div class="quote"><p>Being an ECMAScript Engine author, I shall call you on that.</p>
<p>Semicolons are technically *required* after break, continue, return and throw statements, and newline is now allowed between break and any following identifier token.  Any engine which assumes a newline after a break is a semicolon is violating standard.</p>
<p>When I code in it, I always explicitly write it;</p>
<p>I might also mention that:</p>
<p>if(window.XMLHttpRequest)<br />
    return new XMLHttpRequest();<br />
else if(window.ActiveXObject)<br />
    return new ActiveXObject("msxml2.xmlhttp");<br />
else<br />
    throw new Error("Could not find XMLHttpRequest Object");</p>
<p>works fine, provided you remember to put open before onreadystatechange.</p>
<p>Regards,<br />
Dan
</p>
</div>
	</div>
		<div class="comment" id="c61278">
		<div class="meta">
			<div class="commentnumber"><a href="#c61278">11</a></div>
			<span class="authorname">17yad18izx</span> said on January 19, 2009		</div>
		<div class="quote"><p>Hi! Ebanij vrot! tb7oh8ki77 vn254iax6g!
</p>
</div>
	</div>
		<div class="comment" id="c66401">
		<div class="meta">
			<div class="commentnumber"><a href="#c66401">12</a></div>
			<span class="authorname">lolkitradioto</span> said on March 06, 2011		</div>
		<div class="quote"><p>ceea ce I was privire pentru, multumesc</p>
</div>
	</div>
		


		<div id="commentsclosed">Sorry, comments are closed for this post. If you have any further questions or
	comments, feel free to <a href="https://snook.ca/contact/">send them to me directly</a>.</div>
	</div>
	</div>
	</div>
	<div id="footer">
		<div id="copyright"><div class="shell">
<p class="blurb"> Hi. My name is Jonathan Snook and this is my site. I write about what interests me, which is usually web design, development, and technology. I'm also in the middle of a <a href="https://fifty.snook.ca/">food adventure</a> and I like <a href="https://nook.snook.ca/">whisky</a>.
    <span>I wrote <a href="http://smacss.com/">SMACSS</a>.  I <a href="http://twitter.com/snookca">tweet</a>. Want to <a href="https://snook.ca/about/">learn more</a>? </span>
</p>
			<p>&copy; Jonathan Snook</p>
		</div></div>
	</div>
</body>

<!-- Mirrored from snook.ca/archives/javascript/xmlhttprequest_activex_ie by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 25 Apr 2021 22:04:56 GMT -->
</html>
