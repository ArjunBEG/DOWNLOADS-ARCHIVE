Forked with modifications from https://github.com/zachleat/herald-of-the-dog/